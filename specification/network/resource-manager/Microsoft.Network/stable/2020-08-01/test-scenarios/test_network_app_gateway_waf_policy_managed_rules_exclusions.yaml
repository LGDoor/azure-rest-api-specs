scope: ResourceGroup
testScenarios:
  - description: test_network_app_gateway_waf_policy_managed_rules_exclusions
    steps:
      - step: Create_ApplicationGatewayWebApplicationFirewallPolicies_agp1
        resourceName: ApplicationGatewayWebApplicationFirewallPolicies_agp1
        exampleFile: >-
          ../examples/Create_ApplicationGatewayWebApplicationFirewallPolicies_waf_1_Generated.json
        statusCode: 201
        operationId: WebApplicationFirewallPolicies_CreateOrUpdate
      - step: Update_ApplicationGatewayWebApplicationFirewallPolicies_agp1_321
        resourceName: ApplicationGatewayWebApplicationFirewallPolicies_agp1
        operationId: WebApplicationFirewallPolicies_CreateOrUpdate
        resourceUpdate:
          - add: /properties/managedRules/exclusions/0
            value:
              matchVariable: RequestHeaderNames
              selectorMatchOperator: StartsWith
              selector: Bing
      - step: Update_ApplicationGatewayWebApplicationFirewallPolicies_agp1_323
        resourceName: ApplicationGatewayWebApplicationFirewallPolicies_agp1
        operationId: WebApplicationFirewallPolicies_CreateOrUpdate
        resourceUpdate:
          - add: /properties/managedRules/exclusions/1
            value:
              matchVariable: RequestHeaderNames
              selectorMatchOperator: Contains
              selector: Azure
      - step: Update_ApplicationGatewayWebApplicationFirewallPolicies_agp1_325
        resourceName: ApplicationGatewayWebApplicationFirewallPolicies_agp1
        operationId: WebApplicationFirewallPolicies_CreateOrUpdate
        resourceUpdate:
          - replace: /properties/managedRules/exclusions
            value: []
    variables:
      policyName: agp1
